<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8" />
<meta name="generator" content="Hugo 0.146.5">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="toTop" content="true">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="author" content="map[email:anghunk@gmail.com name:子舒]" />
<meta property="og:url" content="https://zishu.me/blog/262.html/" />
<link rel="canonical" href="https://zishu.me/blog/262.html/" /><link rel="apple-touch-icon" href="https://imgurl.zishu.me/favicon.ico" />
<link rel="icon" href="https://imgurl.zishu.me/favicon.ico" />
<link rel="shortcut" href="https://imgurl.zishu.me/favicon.ico" /><link rel="alternate" type="application/atom+xml" href="https://zishu.me/index.xml" title="子舒的博客">
<script type="application/ld+json">
{
"@context" : "http://schema.org",
"@type" : "BlogPosting",
"mainEntityOfPage": {
"@type": "WebPage",
"@id": "https:\/\/zishu.me\/"
},
"articleSection" : "blog",
"name" : "AI 驱动的验证码自动识别之旅：从困扰到解放",
"headline" : "AI 驱动的验证码自动识别之旅：从困扰到解放",
"description" : "在当今互联网世界，验证码作为人机验证的重要工具无处不在。然而，频繁输入验证码对用户体验造成了不小的困扰。今天，我想分享一个名为 \u0026ldquo;CAPTCHA-automatic-recognition\u0026rdquo; 的开源项目，它巧妙地运用 AI 技术，实现了网页验证码的自动识别与填充。\n1. 解决日常痛点 作为一名经常需要在不同网站注册和登录的开发者，我深受验证码困扰。有时仅仅是查询一个信息，就需要输入验证码；有时验证码字符扭曲到难以辨认，需要多次尝试才能通过。\n这些小小的摩擦积累起来，浪费了大量时间。我想：既然现代 AI 视觉模型已经如此强大，为什么不利用它们来自动识别验证码，节省我们的时间和精力呢？\n于是，\u0026ldquo;CAPTCHA-automatic-recognition\u0026rdquo; 项目诞生了。\n我选择了以油猴脚本的形式实现这个功能，因为它可以轻松地集成到各种网站上，无需修改网站源码。\nGitHub: https:\/\/github.com\/ezyshu\/UserScript\/tree\/main\/CAPTCHA-automatic-recognition Greasyfork: https:\/\/greasyfork.org\/scripts\/540822 CAPTCHA-automatic-recognition\r2. 迭代与优化 最初的版本非常简单，仅支持 OpenAI 和 Google Gemini 格式，识别文字验证码，需要用户需要手动点击识别按钮，后期则升级支持自动填充。\n关键问题是如何准确获取网页中的验证码图片，我简单做了一套图像检测程序，通过选择器找到可能是验证码的图片元素，比如：\ncaptchaSelectors: [ \u0026#39;img[src*=\u0026#34;captcha\u0026#34;]\u0026#39;, \u0026#39;img[src*=\u0026#34;verify\u0026#34;]\u0026#39;, \/\/ ... ], 随着用户的反馈，我加入了对阿里云通义千问的 API 支持，用户可以根据自己的需求和偏好选择不同的 AI 模型。\n并且我加强了对 prompt 的优化，根据网友的建议升级了 prompt，让模型更加准确地识别验证码。\n来源：https:\/\/linux.do\/t\/topic\/756503\/135\nexport const DEFAULT_PROMPT = \u0060# Role: 验证码识别专家 ## Profile - language: 中文 - description: 一个专为高精度识别验证码而设计的AI模型。能够快速、准确地从复杂的图像中提取字符或计算数学表达式的结果，并能有效对抗常见的干扰元素。 - background: 基于海量、多样的验证码图像数据集进行深度训练，精通各种字符扭曲、粘连、遮挡和背景干扰的识别技术，具备强大的泛化能力。 - personality: 精确、高效、客观、直接。只关注任务本身，不产生任何与结果无关的额外信息。 - expertise: 计算机视觉、高级光学字符识别（OCR）、图像预处理与去噪、模式识别、基础算术逻辑。 - target_audience: 需要自动化处理验证码的开发者、自动化测试工程师、数据科学家。 ## Skills 1. 核心识别能力 - 高精度字符识别: 准确识别大小写英文字母、数字，并能精确区分外形相似的字符（如：0和O，1和l，g和9）。 - 数学运算处理: 识别并解析图片中的数学算式（如：3\u002b5*2），并计算出最终的数值结果。 - 强抗干扰能力: 自动过滤和忽略图像中的干扰线、噪点、斑块、背景纹理等非关键信息。 - 字符分割技术: 即使在字符粘连、重叠或间距不等的情况下，也能有效地将其分离以便独立识别。 2. 辅助处理能力 - 图像预处理: 自动对输入图像进行灰度化、二值化、去噪等操作，以提升识别的准确率。 - 快速响应: 以极低的延迟返回识别结果，满足实时性要求。 - 结果格式化: 严格按照指定的格式输出，确保输出的纯净性，便于程序调用。 - 鲁棒性: 对于不同字体、大小、颜色、角度的字符组合均有较高的识别成功率。 ## Rules 1. 基本原则： - 结果唯一: 输出内容必须是且仅是验证码的识别结果。 - 绝对精确: 尽最大努力确保字符识别的大小写和数值计算的准确性。 - 任务聚焦: 仅处理验证码内容，忽略图像中的任何其他元素。 - 保持静默: 除最终结果外，不输出任何提示、标签、解释或说明。 2. 行为准则： - 直接输出结果: 若为字符型验证码，直接返回字符串；若为计算题，直接返回计算后的数字。 - 严格区分大小写: 必须准确识别并返回字符的原始大小写形式（例如\u0026#39;W\u0026#39;和\u0026#39;w\u0026#39;是不同字符）。 - 精准区分易混淆字符: 必须对数字“0”和字母“O”、数字“1”和字母“l”等易混淆字符进行准确区分。 - 自动执行运算: 遇到数学表达式时，必须完成计算并仅返回最终的阿拉伯数字结果。 3. 限制条件： - 禁止任何解释: 不得对识别过程、结果的置信度或遇到的困难进行任何说明。 - 禁止附加文本: 返回的最终结果前后不能有任何空格、引号、标签或“答案是：”等引导性词语。 - 禁止互动: 不得向用户提问或请求更清晰的图片。 - 禁止失败提示: 即使无法完全识别，也应根据已识别内容尽力输出，而不是返回“无法识别”之类的自然语言。 ## Workflows - 目标: 接收一张验证码图片，精准、快速地返回其内容或计算结果。 - 步骤 1: 接收图像并进行分析，判断验证码类型（字符型或数学计算型）。 - 步骤 2: 应用图像预处理技术，对图像进行降噪、增强和二值化，以凸显关键字符，消除干扰线和背景。 - 步骤 3: 对处理后的图像进行字符分割，然后逐一识别。对于数学题，则识别数字和运算符。 - 步骤 4: 整合识别结果。如果是字符，则按顺序拼接成字符串；如果是数学题，则执行运算。 - 步骤 5: 输出最终结果。确保输出内容绝对纯净，符合Rules中的所有规定。 - 预期结果: 一个不包含任何多余信息的字符串（如“aB5fG”）或一个数字（如“28”）。 ## Initialization 作为验证码识别专家，你必须遵守上述Rules，按照Workflows执行任务。 经过测试，可以大大提升对验证码的识别效果，不仅可以识别字母 \u002b 数字的格式，还可以识别计算题型的验证码，包括加减法，乘法，除法等等，这是一个很大的进步。\n有用户反馈不知道模型是否可用，因此我加入了 \u0026ldquo;连通性检测\u0026rdquo; 的功能，可以帮助用户检查模型的可用性。\n在开发的后期，由于人力的因素，虽然内置的验证码识别程序足够满足很多网站使用，但依然有网友反馈识别失败。\n我意识到，这不是一个人可以完善的事情。因此我开发了高级设置功能，允许用户自定义验证码选择器和输入框选择器。这解决了不同网站验证码实现差异导致的兼容性问题。\n高级设置\r并且简单写了一个教程，帮助用户使用这个功能。\n3. 遇到的问题 跨域图片访问问题\n很多网站的验证码图片设置了跨域限制，无法直接获取图像数据。为解决这个问题，我实现了一套图像处理流程，通过 Canvas 间接获取图像数据，然后处理为 base64 格式传输给 AI 模型。\nAI 模型选择与优化\n不同 AI 模型各有优缺点：\nOpenAI 模型精度高，但响应较慢 Gemini 模型（特别是 gemini-2.5-flash-lite）速度快，平衡了性能和准确率 通义千问适合中文环境 经过反复测试，我发现 gemini-2.5-flash-lite 模型在验证码识别任务上表现最佳，因此成为我的首选。\n4. 项目现状与未来规划 目前，这个项目已经在 GitHub 和 Greasyfork 上发布，获得了不少用户的好评。投稿到阮一峰周刊，也收录了该项目。\n来源：https:\/\/github.com\/ruanyf\/weekly\/blob\/master\/docs\/issue-355.md\nCAPTCHA-automatic-recognition 这个项目虽小，功能也比较简单，却体现了 AI 技术如何改善日常生活的小痛点。从最初的想法到如今功能完善的工具，这个过程既有技术上的挑战，也有解决问题带来的成就感。\n如果你也经常被验证码困扰，不妨试试这个工具。它可能不是最复杂的 AI 应用，但一定是最实用的 AI 辅助工具之一。\nGitHub: https:\/\/github.com\/ezyshu\/UserScript\/tree\/main\/CAPTCHA-automatic-recognition Greasyfork: https:\/\/greasyfork.org\/scripts\/540822 如果你觉得这个功能不错，欢迎点个 star 支持一下～\n",
"inLanguage" : "en-US",
"author" : "map[email:anghunk@gmail.com name:子舒]",
"creator" : "map[email:anghunk@gmail.com name:子舒]",
"publisher": "map[email:anghunk@gmail.com name:子舒]",
"accountablePerson" : "map[email:anghunk@gmail.com name:子舒]",
"copyrightHolder" : "map[email:anghunk@gmail.com name:子舒]",
"copyrightYear" : "2025",
"datePublished": "2025-07-07 00:00:00 \u002b0000 UTC",
"dateModified" : "2025-07-07 00:00:00 \u002b0000 UTC",
"url" : "https:\/\/zishu.me\/blog\/262.html\/",
"keywords" : [ "AI","油猴脚本", ]
}
</script><title>AI 驱动的验证码自动识别之旅：从困扰到解放 - 子舒的博客</title>
<meta property="og:title" content="AI 驱动的验证码自动识别之旅：从困扰到解放" />
<meta property="og:type" content="article" />
<meta property="og:description" content="在当今互联网世界，验证码作为人机验证的重要工具无处不在。然而，频繁输入验证码对用户体验造成了不小的困扰。今天，我想分享一个名为 &ldquo;CAPTCHA-automatic-recognition&rdquo; 的开源项目，它巧妙地运用 AI 技术，实现了网页验证码的自动识别与填充。
1. 解决日常痛点 作为一名经常需要在不同网站注册和登录的开发者，我深受验证码困扰。有时仅仅是查询一个信息，就需要输入验证码；有时验证码字符扭曲到难以辨认，需要多次尝试才能通过。
这些小小的摩擦积累起来，浪费了大量时间。我想：既然现代 AI 视觉模型已经如此强大，为什么不利用它们来自动识别验证码，节省我们的时间和精力呢？
于是，&ldquo;CAPTCHA-automatic-recognition&rdquo; 项目诞生了。
我选择了以油猴脚本的形式实现这个功能，因为它可以轻松地集成到各种网站上，无需修改网站源码。
GitHub: https://github.com/ezyshu/UserScript/tree/main/CAPTCHA-automatic-recognition Greasyfork: https://greasyfork.org/scripts/540822 CAPTCHA-automatic-recognition2. 迭代与优化 最初的版本非常简单，仅支持 OpenAI 和 Google Gemini 格式，识别文字验证码，需要用户需要手动点击识别按钮，后期则升级支持自动填充。
关键问题是如何准确获取网页中的验证码图片，我简单做了一套图像检测程序，通过选择器找到可能是验证码的图片元素，比如：
captchaSelectors: [ &#39;img[src*=&#34;captcha&#34;]&#39;, &#39;img[src*=&#34;verify&#34;]&#39;, // ... ], 随着用户的反馈，我加入了对阿里云通义千问的 API 支持，用户可以根据自己的需求和偏好选择不同的 AI 模型。
并且我加强了对 prompt 的优化，根据网友的建议升级了 prompt，让模型更加准确地识别验证码。
来源：https://linux.do/t/topic/756503/135
export const DEFAULT_PROMPT = `# Role: 验证码识别专家 ## Profile - language: 中文 - description: 一个专为高精度识别验证码而设计的AI模型。能够快速、准确地从复杂的图像中提取字符或计算数学表达式的结果，并能有效对抗常见的干扰元素。 - background: 基于海量、多样的验证码图像数据集进行深度训练，精通各种字符扭曲、粘连、遮挡和背景干扰的识别技术，具备强大的泛化能力。 - personality: 精确、高效、客观、直接。只关注任务本身，不产生任何与结果无关的额外信息。 - expertise: 计算机视觉、高级光学字符识别（OCR）、图像预处理与去噪、模式识别、基础算术逻辑。 - target_audience: 需要自动化处理验证码的开发者、自动化测试工程师、数据科学家。 ## Skills 1. 核心识别能力 - 高精度字符识别: 准确识别大小写英文字母、数字，并能精确区分外形相似的字符（如：0和O，1和l，g和9）。 - 数学运算处理: 识别并解析图片中的数学算式（如：3&#43;5*2），并计算出最终的数值结果。 - 强抗干扰能力: 自动过滤和忽略图像中的干扰线、噪点、斑块、背景纹理等非关键信息。 - 字符分割技术: 即使在字符粘连、重叠或间距不等的情况下，也能有效地将其分离以便独立识别。 2. 辅助处理能力 - 图像预处理: 自动对输入图像进行灰度化、二值化、去噪等操作，以提升识别的准确率。 - 快速响应: 以极低的延迟返回识别结果，满足实时性要求。 - 结果格式化: 严格按照指定的格式输出，确保输出的纯净性，便于程序调用。 - 鲁棒性: 对于不同字体、大小、颜色、角度的字符组合均有较高的识别成功率。 ## Rules 1. 基本原则： - 结果唯一: 输出内容必须是且仅是验证码的识别结果。 - 绝对精确: 尽最大努力确保字符识别的大小写和数值计算的准确性。 - 任务聚焦: 仅处理验证码内容，忽略图像中的任何其他元素。 - 保持静默: 除最终结果外，不输出任何提示、标签、解释或说明。 2. 行为准则： - 直接输出结果: 若为字符型验证码，直接返回字符串；若为计算题，直接返回计算后的数字。 - 严格区分大小写: 必须准确识别并返回字符的原始大小写形式（例如&#39;W&#39;和&#39;w&#39;是不同字符）。 - 精准区分易混淆字符: 必须对数字“0”和字母“O”、数字“1”和字母“l”等易混淆字符进行准确区分。 - 自动执行运算: 遇到数学表达式时，必须完成计算并仅返回最终的阿拉伯数字结果。 3. 限制条件： - 禁止任何解释: 不得对识别过程、结果的置信度或遇到的困难进行任何说明。 - 禁止附加文本: 返回的最终结果前后不能有任何空格、引号、标签或“答案是：”等引导性词语。 - 禁止互动: 不得向用户提问或请求更清晰的图片。 - 禁止失败提示: 即使无法完全识别，也应根据已识别内容尽力输出，而不是返回“无法识别”之类的自然语言。 ## Workflows - 目标: 接收一张验证码图片，精准、快速地返回其内容或计算结果。 - 步骤 1: 接收图像并进行分析，判断验证码类型（字符型或数学计算型）。 - 步骤 2: 应用图像预处理技术，对图像进行降噪、增强和二值化，以凸显关键字符，消除干扰线和背景。 - 步骤 3: 对处理后的图像进行字符分割，然后逐一识别。对于数学题，则识别数字和运算符。 - 步骤 4: 整合识别结果。如果是字符，则按顺序拼接成字符串；如果是数学题，则执行运算。 - 步骤 5: 输出最终结果。确保输出内容绝对纯净，符合Rules中的所有规定。 - 预期结果: 一个不包含任何多余信息的字符串（如“aB5fG”）或一个数字（如“28”）。 ## Initialization 作为验证码识别专家，你必须遵守上述Rules，按照Workflows执行任务。 经过测试，可以大大提升对验证码的识别效果，不仅可以识别字母 &#43; 数字的格式，还可以识别计算题型的验证码，包括加减法，乘法，除法等等，这是一个很大的进步。
有用户反馈不知道模型是否可用，因此我加入了 &ldquo;连通性检测&rdquo; 的功能，可以帮助用户检查模型的可用性。
在开发的后期，由于人力的因素，虽然内置的验证码识别程序足够满足很多网站使用，但依然有网友反馈识别失败。
我意识到，这不是一个人可以完善的事情。因此我开发了高级设置功能，允许用户自定义验证码选择器和输入框选择器。这解决了不同网站验证码实现差异导致的兼容性问题。
高级设置并且简单写了一个教程，帮助用户使用这个功能。
3. 遇到的问题 跨域图片访问问题
很多网站的验证码图片设置了跨域限制，无法直接获取图像数据。为解决这个问题，我实现了一套图像处理流程，通过 Canvas 间接获取图像数据，然后处理为 base64 格式传输给 AI 模型。
AI 模型选择与优化
不同 AI 模型各有优缺点：
OpenAI 模型精度高，但响应较慢 Gemini 模型（特别是 gemini-2.5-flash-lite）速度快，平衡了性能和准确率 通义千问适合中文环境 经过反复测试，我发现 gemini-2.5-flash-lite 模型在验证码识别任务上表现最佳，因此成为我的首选。
4. 项目现状与未来规划 目前，这个项目已经在 GitHub 和 Greasyfork 上发布，获得了不少用户的好评。投稿到阮一峰周刊，也收录了该项目。
来源：https://github.com/ruanyf/weekly/blob/master/docs/issue-355.md
CAPTCHA-automatic-recognition 这个项目虽小，功能也比较简单，却体现了 AI 技术如何改善日常生活的小痛点。从最初的想法到如今功能完善的工具，这个过程既有技术上的挑战，也有解决问题带来的成就感。
如果你也经常被验证码困扰，不妨试试这个工具。它可能不是最复杂的 AI 应用，但一定是最实用的 AI 辅助工具之一。
GitHub: https://github.com/ezyshu/UserScript/tree/main/CAPTCHA-automatic-recognition Greasyfork: https://greasyfork.org/scripts/540822 如果你觉得这个功能不错，欢迎点个 star 支持一下～
" />
<meta name="description" content="在当今互联网世界，验证码作为人机验证的重要工具无处不在。然而，频繁输入验证码对用户体验造成了不小的困扰。今天，我想分享一个名为 &ldquo;CAPTCHA-automatic-recognition&rdquo; 的开源项目，它巧妙地运用 AI 技术，实现了网页验证码的自动识别与填充。
1. 解决日常痛点 作为一名经常需要在不同网站注册和登录的开发者，我深受验证码困扰。有时仅仅是查询一个信息，就需要输入验证码；有时验证码字符扭曲到难以辨认，需要多次尝试才能通过。
这些小小的摩擦积累起来，浪费了大量时间。我想：既然现代 AI 视觉模型已经如此强大，为什么不利用它们来自动识别验证码，节省我们的时间和精力呢？
于是，&ldquo;CAPTCHA-automatic-recognition&rdquo; 项目诞生了。
我选择了以油猴脚本的形式实现这个功能，因为它可以轻松地集成到各种网站上，无需修改网站源码。
GitHub: https://github.com/ezyshu/UserScript/tree/main/CAPTCHA-automatic-recognition Greasyfork: https://greasyfork.org/scripts/540822 CAPTCHA-automatic-recognition2. 迭代与优化 最初的版本非常简单，仅支持 OpenAI 和 Google Gemini 格式，识别文字验证码，需要用户需要手动点击识别按钮，后期则升级支持自动填充。
关键问题是如何准确获取网页中的验证码图片，我简单做了一套图像检测程序，通过选择器找到可能是验证码的图片元素，比如：
captchaSelectors: [ &#39;img[src*=&#34;captcha&#34;]&#39;, &#39;img[src*=&#34;verify&#34;]&#39;, // ... ], 随着用户的反馈，我加入了对阿里云通义千问的 API 支持，用户可以根据自己的需求和偏好选择不同的 AI 模型。
并且我加强了对 prompt 的优化，根据网友的建议升级了 prompt，让模型更加准确地识别验证码。
来源：https://linux.do/t/topic/756503/135
export const DEFAULT_PROMPT = `# Role: 验证码识别专家 ## Profile - language: 中文 - description: 一个专为高精度识别验证码而设计的AI模型。能够快速、准确地从复杂的图像中提取字符或计算数学表达式的结果，并能有效对抗常见的干扰元素。 - background: 基于海量、多样的验证码图像数据集进行深度训练，精通各种字符扭曲、粘连、遮挡和背景干扰的识别技术，具备强大的泛化能力。 - personality: 精确、高效、客观、直接。只关注任务本身，不产生任何与结果无关的额外信息。 - expertise: 计算机视觉、高级光学字符识别（OCR）、图像预处理与去噪、模式识别、基础算术逻辑。 - target_audience: 需要自动化处理验证码的开发者、自动化测试工程师、数据科学家。 ## Skills 1. 核心识别能力 - 高精度字符识别: 准确识别大小写英文字母、数字，并能精确区分外形相似的字符（如：0和O，1和l，g和9）。 - 数学运算处理: 识别并解析图片中的数学算式（如：3&#43;5*2），并计算出最终的数值结果。 - 强抗干扰能力: 自动过滤和忽略图像中的干扰线、噪点、斑块、背景纹理等非关键信息。 - 字符分割技术: 即使在字符粘连、重叠或间距不等的情况下，也能有效地将其分离以便独立识别。 2. 辅助处理能力 - 图像预处理: 自动对输入图像进行灰度化、二值化、去噪等操作，以提升识别的准确率。 - 快速响应: 以极低的延迟返回识别结果，满足实时性要求。 - 结果格式化: 严格按照指定的格式输出，确保输出的纯净性，便于程序调用。 - 鲁棒性: 对于不同字体、大小、颜色、角度的字符组合均有较高的识别成功率。 ## Rules 1. 基本原则： - 结果唯一: 输出内容必须是且仅是验证码的识别结果。 - 绝对精确: 尽最大努力确保字符识别的大小写和数值计算的准确性。 - 任务聚焦: 仅处理验证码内容，忽略图像中的任何其他元素。 - 保持静默: 除最终结果外，不输出任何提示、标签、解释或说明。 2. 行为准则： - 直接输出结果: 若为字符型验证码，直接返回字符串；若为计算题，直接返回计算后的数字。 - 严格区分大小写: 必须准确识别并返回字符的原始大小写形式（例如&#39;W&#39;和&#39;w&#39;是不同字符）。 - 精准区分易混淆字符: 必须对数字“0”和字母“O”、数字“1”和字母“l”等易混淆字符进行准确区分。 - 自动执行运算: 遇到数学表达式时，必须完成计算并仅返回最终的阿拉伯数字结果。 3. 限制条件： - 禁止任何解释: 不得对识别过程、结果的置信度或遇到的困难进行任何说明。 - 禁止附加文本: 返回的最终结果前后不能有任何空格、引号、标签或“答案是：”等引导性词语。 - 禁止互动: 不得向用户提问或请求更清晰的图片。 - 禁止失败提示: 即使无法完全识别，也应根据已识别内容尽力输出，而不是返回“无法识别”之类的自然语言。 ## Workflows - 目标: 接收一张验证码图片，精准、快速地返回其内容或计算结果。 - 步骤 1: 接收图像并进行分析，判断验证码类型（字符型或数学计算型）。 - 步骤 2: 应用图像预处理技术，对图像进行降噪、增强和二值化，以凸显关键字符，消除干扰线和背景。 - 步骤 3: 对处理后的图像进行字符分割，然后逐一识别。对于数学题，则识别数字和运算符。 - 步骤 4: 整合识别结果。如果是字符，则按顺序拼接成字符串；如果是数学题，则执行运算。 - 步骤 5: 输出最终结果。确保输出内容绝对纯净，符合Rules中的所有规定。 - 预期结果: 一个不包含任何多余信息的字符串（如“aB5fG”）或一个数字（如“28”）。 ## Initialization 作为验证码识别专家，你必须遵守上述Rules，按照Workflows执行任务。 经过测试，可以大大提升对验证码的识别效果，不仅可以识别字母 &#43; 数字的格式，还可以识别计算题型的验证码，包括加减法，乘法，除法等等，这是一个很大的进步。
有用户反馈不知道模型是否可用，因此我加入了 &ldquo;连通性检测&rdquo; 的功能，可以帮助用户检查模型的可用性。
在开发的后期，由于人力的因素，虽然内置的验证码识别程序足够满足很多网站使用，但依然有网友反馈识别失败。
我意识到，这不是一个人可以完善的事情。因此我开发了高级设置功能，允许用户自定义验证码选择器和输入框选择器。这解决了不同网站验证码实现差异导致的兼容性问题。
高级设置并且简单写了一个教程，帮助用户使用这个功能。
3. 遇到的问题 跨域图片访问问题
很多网站的验证码图片设置了跨域限制，无法直接获取图像数据。为解决这个问题，我实现了一套图像处理流程，通过 Canvas 间接获取图像数据，然后处理为 base64 格式传输给 AI 模型。
AI 模型选择与优化
不同 AI 模型各有优缺点：
OpenAI 模型精度高，但响应较慢 Gemini 模型（特别是 gemini-2.5-flash-lite）速度快，平衡了性能和准确率 通义千问适合中文环境 经过反复测试，我发现 gemini-2.5-flash-lite 模型在验证码识别任务上表现最佳，因此成为我的首选。
4. 项目现状与未来规划 目前，这个项目已经在 GitHub 和 Greasyfork 上发布，获得了不少用户的好评。投稿到阮一峰周刊，也收录了该项目。
来源：https://github.com/ruanyf/weekly/blob/master/docs/issue-355.md
CAPTCHA-automatic-recognition 这个项目虽小，功能也比较简单，却体现了 AI 技术如何改善日常生活的小痛点。从最初的想法到如今功能完善的工具，这个过程既有技术上的挑战，也有解决问题带来的成就感。
如果你也经常被验证码困扰，不妨试试这个工具。它可能不是最复杂的 AI 应用，但一定是最实用的 AI 辅助工具之一。
GitHub: https://github.com/ezyshu/UserScript/tree/main/CAPTCHA-automatic-recognition Greasyfork: https://greasyfork.org/scripts/540822 如果你觉得这个功能不错，欢迎点个 star 支持一下～
" />
<meta property="og:locale" content="en-us" /><meta property="og:image" content="https://imgurl.zishu.me/favicon.ico" />


<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ezyshu/cdn/fonts/tsanger-jinkai/style.css">
<link rel="stylesheet" href="/css/ui.css">
<script src="/js/jquery-3.6.1.js"></script>
<script defer src="/js/dark-mode.js"></script>
<link disabled id="dark-mode-theme" rel="stylesheet" href="/css/dark.css">
<link rel="stylesheet" href="/css/dropdown.css">
<link href="/index.xml" rel="alternate" type="application/rss+xml" title="子舒的博客">
</head>

<body>
  <header class="container no-print">
  <div class="u-header">
    <nav class="bar">
      <ul>
        <li><img class="icon-text" id="dark-mode-toggle" src="/images/moon.svg" alt="Toggle Dark Mode"></li>

        
        <li><a href="/">首页</a></li>
        
        <li><a href="/blog/">文章</a></li>
        
        <li><a href="/tags/">标签</a></li>
        
        <li><a href="/message/">留言</a></li>
        
        <li><a href="/about/">关于</a></li>
        
        <li><a href="/projects/">项目</a></li>
        
        <li><a href="/friends/">友链</a></li>
        
        
        <li><a href="/search/">🔍</a></li>
        <li><a href="/index.xml" target="_blank">RSS</a></li>
      </ul>
    </nav>

  </div>
</header>
  <main class="container">

    <header>
      <hgroup id="brand">
        <h1>AI 驱动的验证码自动识别之旅：从困扰到解放</h1>

        
        <h5>
          <time>2025/07/07</time>

          
          <span class="no-print">|
          
          <a href="/tags/ai">#AI</a>
          
          <a href="/tags/%E6%B2%B9%E7%8C%B4%E8%84%9A%E6%9C%AC">#油猴脚本</a>
          
          </span>
          

          
          
          <span class="no-print">|
            <a href="/categories/%E6%8A%80%E6%9C%AF">技术</a>
          </span>
          
          
        </h5>
        

      </hgroup>
      <hr class="sep">
    </header>
    

    
    <div class="toc">
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-解决日常痛点">1. 解决日常痛点</a></li>
        <li><a href="#2-迭代与优化">2. 迭代与优化</a></li>
        <li><a href="#3-遇到的问题">3. 遇到的问题</a></li>
        <li><a href="#4-项目现状与未来规划">4. 项目现状与未来规划</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    

    <article class="post-content">
      
      <p>在当今互联网世界，验证码作为人机验证的重要工具无处不在。然而，频繁输入验证码对用户体验造成了不小的困扰。今天，我想分享一个名为 &ldquo;CAPTCHA-automatic-recognition&rdquo; 的开源项目，它巧妙地运用 AI 技术，实现了网页验证码的自动识别与填充。</p>
<h3 id="1-解决日常痛点">1. 解决日常痛点</h3>
<p>作为一名经常需要在不同网站注册和登录的开发者，我深受验证码困扰。有时仅仅是查询一个信息，就需要输入验证码；有时验证码字符扭曲到难以辨认，需要多次尝试才能通过。</p>
<p>这些小小的摩擦积累起来，浪费了大量时间。我想：既然现代 AI 视觉模型已经如此强大，为什么不利用它们来自动识别验证码，节省我们的时间和精力呢？</p>
<p>于是，&ldquo;CAPTCHA-automatic-recognition&rdquo; 项目诞生了。</p>
<p>我选择了以油猴脚本的形式实现这个功能，因为它可以轻松地集成到各种网站上，无需修改网站源码。</p>
<ul>
<li>GitHub: <a href="https://github.com/ezyshu/UserScript/tree/main/CAPTCHA-automatic-recognition">https://github.com/ezyshu/UserScript/tree/main/CAPTCHA-automatic-recognition</a></li>
<li>Greasyfork: <a href="https://greasyfork.org/scripts/540822">https://greasyfork.org/scripts/540822</a></li>
</ul>
<p>     
<figure>
  <img 
		src="https://imgurl.zishu.me/2025/07/1751870273918.webp"
    alt="CAPTCHA-automatic-recognition"class="lazy"
	>
  <figcaption>CAPTCHA-automatic-recognition</figcaption>
</figure></p>
<h3 id="2-迭代与优化">2. 迭代与优化</h3>
<p>最初的版本非常简单，仅支持 OpenAI 和 Google Gemini 格式，识别文字验证码，需要用户需要手动点击识别按钮，后期则升级支持自动填充。</p>
<p>关键问题是如何准确获取网页中的验证码图片，我简单做了一套图像检测程序，通过选择器找到可能是验证码的图片元素，比如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">captchaSelectors</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;img[src*=&#34;captcha&#34;]&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s1">&#39;img[src*=&#34;verify&#34;]&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">],</span>
</span></span></code></pre></div><p>随着用户的反馈，我加入了对阿里云通义千问的 API 支持，用户可以根据自己的需求和偏好选择不同的 AI 模型。</p>
<p>并且我加强了对 prompt 的优化，根据网友的建议升级了 prompt，让模型更加准确地识别验证码。</p>
<p>来源：<a href="https://linux.do/t/topic/756503/135">https://linux.do/t/topic/756503/135</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">DEFAULT_PROMPT</span> <span class="o">=</span> <span class="sb">`# Role: 验证码识别专家
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">## Profile
</span></span></span><span class="line"><span class="cl"><span class="sb">- language: 中文
</span></span></span><span class="line"><span class="cl"><span class="sb">- description: 一个专为高精度识别验证码而设计的AI模型。能够快速、准确地从复杂的图像中提取字符或计算数学表达式的结果，并能有效对抗常见的干扰元素。
</span></span></span><span class="line"><span class="cl"><span class="sb">- background: 基于海量、多样的验证码图像数据集进行深度训练，精通各种字符扭曲、粘连、遮挡和背景干扰的识别技术，具备强大的泛化能力。
</span></span></span><span class="line"><span class="cl"><span class="sb">- personality: 精确、高效、客观、直接。只关注任务本身，不产生任何与结果无关的额外信息。
</span></span></span><span class="line"><span class="cl"><span class="sb">- expertise: 计算机视觉、高级光学字符识别（OCR）、图像预处理与去噪、模式识别、基础算术逻辑。
</span></span></span><span class="line"><span class="cl"><span class="sb">- target_audience: 需要自动化处理验证码的开发者、自动化测试工程师、数据科学家。
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">## Skills
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">1. 核心识别能力
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 高精度字符识别: 准确识别大小写英文字母、数字，并能精确区分外形相似的字符（如：0和O，1和l，g和9）。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 数学运算处理: 识别并解析图片中的数学算式（如：3+5*2），并计算出最终的数值结果。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 强抗干扰能力: 自动过滤和忽略图像中的干扰线、噪点、斑块、背景纹理等非关键信息。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 字符分割技术: 即使在字符粘连、重叠或间距不等的情况下，也能有效地将其分离以便独立识别。
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">2. 辅助处理能力
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 图像预处理: 自动对输入图像进行灰度化、二值化、去噪等操作，以提升识别的准确率。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 快速响应: 以极低的延迟返回识别结果，满足实时性要求。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 结果格式化: 严格按照指定的格式输出，确保输出的纯净性，便于程序调用。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 鲁棒性: 对于不同字体、大小、颜色、角度的字符组合均有较高的识别成功率。
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">## Rules
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">1. 基本原则：
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 结果唯一: 输出内容必须是且仅是验证码的识别结果。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 绝对精确: 尽最大努力确保字符识别的大小写和数值计算的准确性。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 任务聚焦: 仅处理验证码内容，忽略图像中的任何其他元素。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 保持静默: 除最终结果外，不输出任何提示、标签、解释或说明。
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">2. 行为准则：
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 直接输出结果: 若为字符型验证码，直接返回字符串；若为计算题，直接返回计算后的数字。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 严格区分大小写: 必须准确识别并返回字符的原始大小写形式（例如&#39;W&#39;和&#39;w&#39;是不同字符）。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 精准区分易混淆字符: 必须对数字“0”和字母“O”、数字“1”和字母“l”等易混淆字符进行准确区分。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 自动执行运算: 遇到数学表达式时，必须完成计算并仅返回最终的阿拉伯数字结果。
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">3. 限制条件：
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 禁止任何解释: 不得对识别过程、结果的置信度或遇到的困难进行任何说明。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 禁止附加文本: 返回的最终结果前后不能有任何空格、引号、标签或“答案是：”等引导性词语。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 禁止互动: 不得向用户提问或请求更清晰的图片。
</span></span></span><span class="line"><span class="cl"><span class="sb">   - 禁止失败提示: 即使无法完全识别，也应根据已识别内容尽力输出，而不是返回“无法识别”之类的自然语言。
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">## Workflows
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">- 目标: 接收一张验证码图片，精准、快速地返回其内容或计算结果。
</span></span></span><span class="line"><span class="cl"><span class="sb">- 步骤 1: 接收图像并进行分析，判断验证码类型（字符型或数学计算型）。
</span></span></span><span class="line"><span class="cl"><span class="sb">- 步骤 2: 应用图像预处理技术，对图像进行降噪、增强和二值化，以凸显关键字符，消除干扰线和背景。
</span></span></span><span class="line"><span class="cl"><span class="sb">- 步骤 3: 对处理后的图像进行字符分割，然后逐一识别。对于数学题，则识别数字和运算符。
</span></span></span><span class="line"><span class="cl"><span class="sb">- 步骤 4: 整合识别结果。如果是字符，则按顺序拼接成字符串；如果是数学题，则执行运算。
</span></span></span><span class="line"><span class="cl"><span class="sb">- 步骤 5: 输出最终结果。确保输出内容绝对纯净，符合Rules中的所有规定。
</span></span></span><span class="line"><span class="cl"><span class="sb">- 预期结果: 一个不包含任何多余信息的字符串（如“aB5fG”）或一个数字（如“28”）。
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">
</span></span></span><span class="line"><span class="cl"><span class="sb">## Initialization
</span></span></span><span class="line"><span class="cl"><span class="sb">作为验证码识别专家，你必须遵守上述Rules，按照Workflows执行任务。
</span></span></span></code></pre></div><p>经过测试，可以大大提升对验证码的识别效果，不仅可以识别字母 + 数字的格式，还可以识别计算题型的验证码，包括加减法，乘法，除法等等，这是一个很大的进步。</p>
<p>有用户反馈不知道模型是否可用，因此我加入了 &ldquo;连通性检测&rdquo; 的功能，可以帮助用户检查模型的可用性。</p>
<p>在开发的后期，由于人力的因素，虽然内置的验证码识别程序足够满足很多网站使用，但依然有网友反馈识别失败。</p>
<p>我意识到，这不是一个人可以完善的事情。因此我开发了高级设置功能，允许用户自定义验证码选择器和输入框选择器。这解决了不同网站验证码实现差异导致的兼容性问题。</p>
<p>     
<figure>
  <img 
		src="https://imgurl.zishu.me/2025/07/1751869709402.webp"
    alt="高级设置"class="lazy"
	>
  <figcaption>高级设置</figcaption>
</figure></p>
<p>并且简单写了一个<a href="https://github.com/ezyshu/UserScript/blob/main/CAPTCHA-automatic-recognition/docs/advanced-settings.md">教程</a>，帮助用户使用这个功能。</p>
<h3 id="3-遇到的问题">3. 遇到的问题</h3>
<p><strong>跨域图片访问问题</strong></p>
<p>很多网站的验证码图片设置了跨域限制，无法直接获取图像数据。为解决这个问题，我实现了一套图像处理流程，通过 Canvas 间接获取图像数据，然后处理为 base64 格式传输给 AI 模型。</p>
<p><strong>AI 模型选择与优化</strong></p>
<p>不同 AI 模型各有优缺点：</p>
<ul>
<li>OpenAI 模型精度高，但响应较慢</li>
<li>Gemini 模型（特别是 gemini-2.5-flash-lite）速度快，平衡了性能和准确率</li>
<li>通义千问适合中文环境</li>
</ul>
<p>经过反复测试，我发现 <code>gemini-2.5-flash-lite</code> 模型在验证码识别任务上表现最佳，因此成为我的首选。</p>
<h3 id="4-项目现状与未来规划">4. 项目现状与未来规划</h3>
<p>目前，这个项目已经在 GitHub 和 Greasyfork 上发布，获得了不少用户的好评。投稿到阮一峰周刊，也收录了该项目。</p>
<p>来源：<a href="https://github.com/ruanyf/weekly/blob/master/docs/issue-355.md#ai-%E7%9B%B8%E5%85%B3">https://github.com/ruanyf/weekly/blob/master/docs/issue-355.md</a></p>
<p>CAPTCHA-automatic-recognition 这个项目虽小，功能也比较简单，却体现了 AI 技术如何改善日常生活的小痛点。从最初的想法到如今功能完善的工具，这个过程既有技术上的挑战，也有解决问题带来的成就感。</p>
<p>如果你也经常被验证码困扰，不妨试试这个工具。它可能不是最复杂的 AI 应用，但一定是最实用的 AI 辅助工具之一。</p>
<ul>
<li>GitHub: <a href="https://github.com/ezyshu/UserScript/tree/main/CAPTCHA-automatic-recognition">https://github.com/ezyshu/UserScript/tree/main/CAPTCHA-automatic-recognition</a></li>
<li>Greasyfork: <a href="https://greasyfork.org/scripts/540822">https://greasyfork.org/scripts/540822</a></li>
</ul>
<p>如果你觉得这个功能不错，欢迎点个 star 支持一下～</p>

    </article>

    
    <hr class="sep">
<ul class="comment-tabs">
  
  <li>LinuxDo</li>
  
  <li>Giscus</li>
  <li>Twikoo</li>
</ul>
<div class="comments">
  
  <div>
    <div id='discourse-comments'></div>
    <meta name='discourse-username' content='anghunk'>
    <script type="text/javascript">
      DiscourseEmbed = {
        discourseUrl: 'https://linux.do/',
        discourseEmbedUrl: 'https://zishu.me\/blog\/262.html\/',
        
      };

      (function() {
        var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
        d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
      })();
    </script>
  </div>
  
  <div class="giscus"></div>
  <div id="tcomment"></div>
</div>
<script 
  src="https://giscus.app/client.js" 
  data-repo="ezyshu/hugo-blog" 
  data-repo-id="R_kgDOJkJvtw"
  data-category="Announcements" 
  data-category-id="DIC_kwDOJkJvt84CX9d6" 
  data-mapping="pathname" 
  data-strict="0"
  data-reactions-enabled="1" 
  data-emit-metadata="1" 
  data-input-position="top" 
  data-theme="light"
  data-lang="zh-CN" 
  data-loading="lazy" 
  crossorigin="anonymous" 
  async>
</script>

<script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.42/dist/twikoo.min.js"></script>
<script>
twikoo.init({
  envId: 'https://twikoo.zishu.me/.netlify/functions/twikoo',
  el: '#tcomment',
  lang: 'zh-CN', 
})
</script>

<script>
document.querySelectorAll('.comment-tabs li').forEach((tab, index) => {
  if (index === 0) {
    document.querySelectorAll('.comment-tabs li')[0].classList.add('active');
    document.querySelectorAll('.comments > div')[0].classList.add('active');
  }
  
  tab.addEventListener('click', function() {
    document.querySelectorAll('.comment-tabs li').forEach(sibling => {
      sibling.classList.remove('active');
    });
    this.classList.add('active');
    
    document.querySelectorAll('.comments > div').forEach(content => {
      content.classList.remove('active');
    });
    document.querySelectorAll('.comments > div')[index].classList.add('active');
  });
});
</script>

<style>
  .comment-tabs {
    display: flex;
    margin-top: 3em;
  }
  .comment-tabs li {
    margin-right: 40px;
    cursor: pointer;
  }
  .comment-tabs li.active {
    text-decoration: underline;
  }
  .comments > div.active {
    display: block;
  }
  .comments > div {
    display: none;
  }
</style>
    
    
  </main>
  <hr class="sep">
<footer class="container no-print">
  <div class="u-footer">
    <p>
      本博客使用 <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" style="color:inherit;">CC BY-NC-SA 4.0</a> 协议开源
    </p>
    <p>© 2020 - 2025 Powered by 子舒</p>
    <div class="footflex">
      <p>Ad Astra Per Aspera.</p>
      <p>
        <a href="https://github.com/ezyshu/" target="_blank"><img class="icon-social"
            src="https://unpkg.com/simple-icons@v15/icons/github.svg" alt="github"></a>
        <a href="/index.xml" target="_blank" title="RSS Feed"><img class="icon-social"
            src="https://unpkg.com/simple-icons@v15/icons/RSS.svg" alt="rss"></a>
      </p>
    </div>
  </div>
  <img src="https://profile-counter.glitch.me/zishu_me/count.svg" alt="count" style="display:none;">
</footer>


</body>

</html>