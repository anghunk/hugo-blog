<!DOCTYPE html>
<html lang="en-US">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="http://localhost:1313/images/favicon.png" />
<title>Python &#43; GPT 自动翻译 README 文档 | Hugo ʕ•ᴥ•ʔ Bear Blog</title>
<meta name="title" content="Python &#43; GPT 自动翻译 README 文档" />
<meta name="description" content="在开发个人项目时，写 README 文件一直是一件很头疼的事情，所幸辛苦写完了，想做个多语言版本更头疼，为了解决整个痛点，写了个 python &#43; GPT 脚本，将这一切自动化处理了。
源码：https://github.com/dlzmoe/translate-README
在根目录下新建俩文件 .env 和 translate_md.py：
1OPENAI_URL=https://api.openai.com/v1/chat/completions
2API_KEY=your_api_key_here
3MODEL=gpt-4o-mini
4INPUT_FILE=README.md
5OUTPUT_FILE=README_EN.md
6TARGET_LANGUAGE=en
个人是比较喜欢 gpt-4o-mini 这个模型，功能足够覆盖我日常使用，生成速度快，对 token 的消耗也比较低，作图生文、理解性也都是前排水平。
 1# translate_md.py
 2import os
 3import requests
 4from dotenv import load_dotenv
 5
 6# 加载 .env 文件中的环境变量
 7load_dotenv()
 8
 9# 配置选项
10OPENAI_URL = os.getenv(&#34;OPENAI_URL&#34;)
11API_KEY = os.getenv(&#34;API_KEY&#34;)
12MODEL = os.getenv(&#34;MODEL&#34;)
13INPUT_FILE = os.getenv(&#34;INPUT_FILE&#34;)
14OUTPUT_FILE = os.getenv(&#34;OUTPUT_FILE&#34;)
15TARGET_LANGUAGE = os.getenv(&#34;TARGET_LANGUAGE&#34;)
16
17def read_markdown_file(file_path):
18    with open(file_path, &#39;r&#39;, encoding=&#39;utf-8&#39;) as file:
19        return file.read()
20
21def write_markdown_file(file_path, content):
22    with open(file_path, &#39;w&#39;, encoding=&#39;utf-8&#39;) as file:
23        file.write(content)
24
25def translate_text(text):
26    headers = {
27        &#34;Authorization&#34;: f&#34;Bearer {API_KEY}&#34;,
28        &#34;Content-Type&#34;: &#34;application/json&#34;
29    }
30    
31    prompt = f&#34;Translate the following text to {TARGET_LANGUAGE} Markdown syntax is not preserved :\n\n{text}&#34;
32    
33    data = {
34        &#34;model&#34;: MODEL,
35        &#34;messages&#34;: [{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: prompt}]
36    }
37    
38    response = requests.post(OPENAI_URL, headers=headers, json=data)
39    
40    if response.status_code == 200:
41        return response.json()[&#39;choices&#39;][0][&#39;message&#39;][&#39;content&#39;]
42    else:
43        print(f&#34;Error: {response.status_code} - {response.text}&#34;)
44        return None
45
46def main():
47    if not os.path.exists(INPUT_FILE):
48        print(f&#34;Input file {INPUT_FILE} does not exist.&#34;)
49        return
50    
51    # 读取 Markdown 文件
52    markdown_content = read_markdown_file(INPUT_FILE)
53    
54    # 去除头尾的 ``` 语法
55    # 这里假设 markdown_content 的开头和结尾没有其他内容，只是代码块
56    if markdown_content.startswith(&#39;```&#39;):
57        markdown_content = markdown_content[3:].strip()
58    if markdown_content.endswith(&#39;```&#39;):
59        markdown_content = markdown_content[:-3].strip()
60    
61    # 翻译文本
62    translated_content = translate_text(markdown_content)
63    
64    if translated_content:
65        # 写入翻译后的内容到输出文件
66        write_markdown_file(OUTPUT_FILE, translated_content)
67        print(f&#34;Translation completed. Output saved to {OUTPUT_FILE}.&#34;)
68    else:
69        print(&#34;Translation failed.&#34;)
70
71if __name__ == &#34;__main__&#34;:
72    main()
文件创建完成后安装一下依赖：" />
<meta name="keywords" content="Python,GPT," />


<meta property="og:url" content="http://localhost:1313/239/">
  <meta property="og:site_name" content="Hugo ʕ•ᴥ•ʔ Bear Blog">
  <meta property="og:title" content="Python &#43; GPT 自动翻译 README 文档">
  <meta property="og:description" content="在开发个人项目时，写 README 文件一直是一件很头疼的事情，所幸辛苦写完了，想做个多语言版本更头疼，为了解决整个痛点，写了个 python &#43; GPT 脚本，将这一切自动化处理了。
源码：https://github.com/dlzmoe/translate-README
在根目录下新建俩文件 .env 和 translate_md.py：
1OPENAI_URL=https://api.openai.com/v1/chat/completions 2API_KEY=your_api_key_here 3MODEL=gpt-4o-mini 4INPUT_FILE=README.md 5OUTPUT_FILE=README_EN.md 6TARGET_LANGUAGE=en 个人是比较喜欢 gpt-4o-mini 这个模型，功能足够覆盖我日常使用，生成速度快，对 token 的消耗也比较低，作图生文、理解性也都是前排水平。
1# translate_md.py 2import os 3import requests 4from dotenv import load_dotenv 5 6# 加载 .env 文件中的环境变量 7load_dotenv() 8 9# 配置选项 10OPENAI_URL = os.getenv(&#34;OPENAI_URL&#34;) 11API_KEY = os.getenv(&#34;API_KEY&#34;) 12MODEL = os.getenv(&#34;MODEL&#34;) 13INPUT_FILE = os.getenv(&#34;INPUT_FILE&#34;) 14OUTPUT_FILE = os.getenv(&#34;OUTPUT_FILE&#34;) 15TARGET_LANGUAGE = os.getenv(&#34;TARGET_LANGUAGE&#34;) 16 17def read_markdown_file(file_path): 18 with open(file_path, &#39;r&#39;, encoding=&#39;utf-8&#39;) as file: 19 return file.read() 20 21def write_markdown_file(file_path, content): 22 with open(file_path, &#39;w&#39;, encoding=&#39;utf-8&#39;) as file: 23 file.write(content) 24 25def translate_text(text): 26 headers = { 27 &#34;Authorization&#34;: f&#34;Bearer {API_KEY}&#34;, 28 &#34;Content-Type&#34;: &#34;application/json&#34; 29 } 30 31 prompt = f&#34;Translate the following text to {TARGET_LANGUAGE} Markdown syntax is not preserved :\n\n{text}&#34; 32 33 data = { 34 &#34;model&#34;: MODEL, 35 &#34;messages&#34;: [{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: prompt}] 36 } 37 38 response = requests.post(OPENAI_URL, headers=headers, json=data) 39 40 if response.status_code == 200: 41 return response.json()[&#39;choices&#39;][0][&#39;message&#39;][&#39;content&#39;] 42 else: 43 print(f&#34;Error: {response.status_code} - {response.text}&#34;) 44 return None 45 46def main(): 47 if not os.path.exists(INPUT_FILE): 48 print(f&#34;Input file {INPUT_FILE} does not exist.&#34;) 49 return 50 51 # 读取 Markdown 文件 52 markdown_content = read_markdown_file(INPUT_FILE) 53 54 # 去除头尾的 ``` 语法 55 # 这里假设 markdown_content 的开头和结尾没有其他内容，只是代码块 56 if markdown_content.startswith(&#39;```&#39;): 57 markdown_content = markdown_content[3:].strip() 58 if markdown_content.endswith(&#39;```&#39;): 59 markdown_content = markdown_content[:-3].strip() 60 61 # 翻译文本 62 translated_content = translate_text(markdown_content) 63 64 if translated_content: 65 # 写入翻译后的内容到输出文件 66 write_markdown_file(OUTPUT_FILE, translated_content) 67 print(f&#34;Translation completed. Output saved to {OUTPUT_FILE}.&#34;) 68 else: 69 print(&#34;Translation failed.&#34;) 70 71if __name__ == &#34;__main__&#34;: 72 main() 文件创建完成后安装一下依赖：">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-09-09T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-09-09T00:00:00+00:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="GPT">
    <meta property="og:image" content="http://localhost:1313/images/share.png">




  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/images/share.png">
  <meta name="twitter:title" content="Python &#43; GPT 自动翻译 README 文档">
  <meta name="twitter:description" content="在开发个人项目时，写 README 文件一直是一件很头疼的事情，所幸辛苦写完了，想做个多语言版本更头疼，为了解决整个痛点，写了个 python &#43; GPT 脚本，将这一切自动化处理了。
源码：https://github.com/dlzmoe/translate-README
在根目录下新建俩文件 .env 和 translate_md.py：
1OPENAI_URL=https://api.openai.com/v1/chat/completions 2API_KEY=your_api_key_here 3MODEL=gpt-4o-mini 4INPUT_FILE=README.md 5OUTPUT_FILE=README_EN.md 6TARGET_LANGUAGE=en 个人是比较喜欢 gpt-4o-mini 这个模型，功能足够覆盖我日常使用，生成速度快，对 token 的消耗也比较低，作图生文、理解性也都是前排水平。
1# translate_md.py 2import os 3import requests 4from dotenv import load_dotenv 5 6# 加载 .env 文件中的环境变量 7load_dotenv() 8 9# 配置选项 10OPENAI_URL = os.getenv(&#34;OPENAI_URL&#34;) 11API_KEY = os.getenv(&#34;API_KEY&#34;) 12MODEL = os.getenv(&#34;MODEL&#34;) 13INPUT_FILE = os.getenv(&#34;INPUT_FILE&#34;) 14OUTPUT_FILE = os.getenv(&#34;OUTPUT_FILE&#34;) 15TARGET_LANGUAGE = os.getenv(&#34;TARGET_LANGUAGE&#34;) 16 17def read_markdown_file(file_path): 18 with open(file_path, &#39;r&#39;, encoding=&#39;utf-8&#39;) as file: 19 return file.read() 20 21def write_markdown_file(file_path, content): 22 with open(file_path, &#39;w&#39;, encoding=&#39;utf-8&#39;) as file: 23 file.write(content) 24 25def translate_text(text): 26 headers = { 27 &#34;Authorization&#34;: f&#34;Bearer {API_KEY}&#34;, 28 &#34;Content-Type&#34;: &#34;application/json&#34; 29 } 30 31 prompt = f&#34;Translate the following text to {TARGET_LANGUAGE} Markdown syntax is not preserved :\n\n{text}&#34; 32 33 data = { 34 &#34;model&#34;: MODEL, 35 &#34;messages&#34;: [{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: prompt}] 36 } 37 38 response = requests.post(OPENAI_URL, headers=headers, json=data) 39 40 if response.status_code == 200: 41 return response.json()[&#39;choices&#39;][0][&#39;message&#39;][&#39;content&#39;] 42 else: 43 print(f&#34;Error: {response.status_code} - {response.text}&#34;) 44 return None 45 46def main(): 47 if not os.path.exists(INPUT_FILE): 48 print(f&#34;Input file {INPUT_FILE} does not exist.&#34;) 49 return 50 51 # 读取 Markdown 文件 52 markdown_content = read_markdown_file(INPUT_FILE) 53 54 # 去除头尾的 ``` 语法 55 # 这里假设 markdown_content 的开头和结尾没有其他内容，只是代码块 56 if markdown_content.startswith(&#39;```&#39;): 57 markdown_content = markdown_content[3:].strip() 58 if markdown_content.endswith(&#39;```&#39;): 59 markdown_content = markdown_content[:-3].strip() 60 61 # 翻译文本 62 translated_content = translate_text(markdown_content) 63 64 if translated_content: 65 # 写入翻译后的内容到输出文件 66 write_markdown_file(OUTPUT_FILE, translated_content) 67 print(f&#34;Translation completed. Output saved to {OUTPUT_FILE}.&#34;) 68 else: 69 print(&#34;Translation failed.&#34;) 70 71if __name__ == &#34;__main__&#34;: 72 main() 文件创建完成后安装一下依赖：">




  <meta itemprop="name" content="Python &#43; GPT 自动翻译 README 文档">
  <meta itemprop="description" content="在开发个人项目时，写 README 文件一直是一件很头疼的事情，所幸辛苦写完了，想做个多语言版本更头疼，为了解决整个痛点，写了个 python &#43; GPT 脚本，将这一切自动化处理了。
源码：https://github.com/dlzmoe/translate-README
在根目录下新建俩文件 .env 和 translate_md.py：
1OPENAI_URL=https://api.openai.com/v1/chat/completions 2API_KEY=your_api_key_here 3MODEL=gpt-4o-mini 4INPUT_FILE=README.md 5OUTPUT_FILE=README_EN.md 6TARGET_LANGUAGE=en 个人是比较喜欢 gpt-4o-mini 这个模型，功能足够覆盖我日常使用，生成速度快，对 token 的消耗也比较低，作图生文、理解性也都是前排水平。
1# translate_md.py 2import os 3import requests 4from dotenv import load_dotenv 5 6# 加载 .env 文件中的环境变量 7load_dotenv() 8 9# 配置选项 10OPENAI_URL = os.getenv(&#34;OPENAI_URL&#34;) 11API_KEY = os.getenv(&#34;API_KEY&#34;) 12MODEL = os.getenv(&#34;MODEL&#34;) 13INPUT_FILE = os.getenv(&#34;INPUT_FILE&#34;) 14OUTPUT_FILE = os.getenv(&#34;OUTPUT_FILE&#34;) 15TARGET_LANGUAGE = os.getenv(&#34;TARGET_LANGUAGE&#34;) 16 17def read_markdown_file(file_path): 18 with open(file_path, &#39;r&#39;, encoding=&#39;utf-8&#39;) as file: 19 return file.read() 20 21def write_markdown_file(file_path, content): 22 with open(file_path, &#39;w&#39;, encoding=&#39;utf-8&#39;) as file: 23 file.write(content) 24 25def translate_text(text): 26 headers = { 27 &#34;Authorization&#34;: f&#34;Bearer {API_KEY}&#34;, 28 &#34;Content-Type&#34;: &#34;application/json&#34; 29 } 30 31 prompt = f&#34;Translate the following text to {TARGET_LANGUAGE} Markdown syntax is not preserved :\n\n{text}&#34; 32 33 data = { 34 &#34;model&#34;: MODEL, 35 &#34;messages&#34;: [{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: prompt}] 36 } 37 38 response = requests.post(OPENAI_URL, headers=headers, json=data) 39 40 if response.status_code == 200: 41 return response.json()[&#39;choices&#39;][0][&#39;message&#39;][&#39;content&#39;] 42 else: 43 print(f&#34;Error: {response.status_code} - {response.text}&#34;) 44 return None 45 46def main(): 47 if not os.path.exists(INPUT_FILE): 48 print(f&#34;Input file {INPUT_FILE} does not exist.&#34;) 49 return 50 51 # 读取 Markdown 文件 52 markdown_content = read_markdown_file(INPUT_FILE) 53 54 # 去除头尾的 ``` 语法 55 # 这里假设 markdown_content 的开头和结尾没有其他内容，只是代码块 56 if markdown_content.startswith(&#39;```&#39;): 57 markdown_content = markdown_content[3:].strip() 58 if markdown_content.endswith(&#39;```&#39;): 59 markdown_content = markdown_content[:-3].strip() 60 61 # 翻译文本 62 translated_content = translate_text(markdown_content) 63 64 if translated_content: 65 # 写入翻译后的内容到输出文件 66 write_markdown_file(OUTPUT_FILE, translated_content) 67 print(f&#34;Translation completed. Output saved to {OUTPUT_FILE}.&#34;) 68 else: 69 print(&#34;Translation failed.&#34;) 70 71if __name__ == &#34;__main__&#34;: 72 main() 文件创建完成后安装一下依赖：">
  <meta itemprop="datePublished" content="2024-09-09T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-09-09T00:00:00+00:00">
  <meta itemprop="wordCount" content="258">
  <meta itemprop="image" content="http://localhost:1313/images/share.png">
  <meta itemprop="keywords" content="Python,GPT">
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  :root {
    --width: 720px;
    --font-main: Verdana, sans-serif;
    --font-secondary: Verdana, sans-serif;
    --font-scale: 1em;
    --background-color: #fff;
    --heading-color: #222;
    --text-color: #444;
    --link-color: #3273dc;
    --visited-color: #8b6fcb;
    --code-background-color: #f2f2f2;
    --code-color: #222;
    --blockquote-color: #222;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --background-color: #01242e;
      --heading-color: #eee;
      --text-color: #ddd;
      --link-color: #8cc2dd;
      --visited-color: #8b6fcb;
      --code-background-color: #000;
      --code-color: #ddd;
      --blockquote-color: #ccc;
    }
  }

  body {
    font-family: var(--font-secondary);
    font-size: var(--font-scale);
    margin: auto;
    padding: 20px;
    max-width: var(--width);
    text-align: left;
    background-color: var(--background-color);
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: var(--text-color);
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: var(--font-main);
    color: var(--heading-color);
  }

  a {
    color: var(--link-color);
    cursor: pointer;
    text-decoration: none;
  }

  a:hover {
    text-decoration: underline;
  }

  nav a {
    margin-right: 8px;
  }

  strong,
  b {
    color: var(--heading-color);
  }

  button {
    margin: 0;
    cursor: pointer;
  }

  time {
    font-family: monospace;
    font-style: normal;
    font-size: 15px;
  }

  main {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  hr {
    border: 0;
    border-top: 1px dashed;
  }

  img {
    max-width: 100%;
  }

  code {
    font-family: monospace;
    padding: 2px;
    background-color: var(--code-background-color);
    color: var(--code-color);
    border-radius: 3px;
  }

  blockquote {
    border-left: 1px solid #999;
    color: var(--code-color);
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px 0;
    text-align: center;
  }

  .title:hover {
    text-decoration: none;
  }

  .title h1 {
    font-size: 1.5em;
  }

  .inline {
    width: auto !important;
  }

  .highlight,
  .code {
    padding: 1px 15px;
    background-color: var(--code-background-color);
    color: var(--code-color);
    border-radius: 3px;
    margin-block-start: 1em;
    margin-block-end: 1em;
    overflow-x: auto;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
    color: var(--visited-color);
  }

</style>

</head>

<body>
  <header><a href="/" class="title">
  <h2>Hugo ʕ•ᴥ•ʔ Bear Blog</h2>
</a>
<nav>
</nav>
</header>
  <main>

<h1>Python &#43; GPT 自动翻译 README 文档</h1>
<p>
  <i>
    <time datetime='2024-09-09'>
      09 Sep, 2024
    </time>
  </i>
</p>

<content>
  <p>在开发个人项目时，写 README 文件一直是一件很头疼的事情，所幸辛苦写完了，想做个多语言版本更头疼，为了解决整个痛点，写了个 python + GPT 脚本，将这一切自动化处理了。</p>
<p>源码：https://github.com/dlzmoe/translate-README</p>
<p>在根目录下新建俩文件 <code>.env</code> 和 <code>translate_md.py</code>：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#bb60d5">OPENAI_URL</span><span style="color:#666">=</span>https://api.openai.com/v1/chat/completions
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#bb60d5">API_KEY</span><span style="color:#666">=</span>your_api_key_here
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#bb60d5">MODEL</span><span style="color:#666">=</span>gpt-4o-mini
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#bb60d5">INPUT_FILE</span><span style="color:#666">=</span>README.md
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#bb60d5">OUTPUT_FILE</span><span style="color:#666">=</span>README_EN.md
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#bb60d5">TARGET_LANGUAGE</span><span style="color:#666">=</span>en
</span></span></code></pre></div><p>个人是比较喜欢 <code>gpt-4o-mini</code> 这个模型，功能足够覆盖我日常使用，生成速度快，对 token 的消耗也比较低，作图生文、理解性也都是前排水平。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#60a0b0;font-style:italic"># translate_md.py</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">os</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">requests</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#007020;font-weight:bold">from</span> <span style="color:#0e84b5;font-weight:bold">dotenv</span> <span style="color:#007020;font-weight:bold">import</span> load_dotenv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#60a0b0;font-style:italic"># 加载 .env 文件中的环境变量</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>load_dotenv()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#60a0b0;font-style:italic"># 配置选项</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>OPENAI_URL <span style="color:#666">=</span> os<span style="color:#666">.</span>getenv(<span style="color:#4070a0">&#34;OPENAI_URL&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>API_KEY <span style="color:#666">=</span> os<span style="color:#666">.</span>getenv(<span style="color:#4070a0">&#34;API_KEY&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>MODEL <span style="color:#666">=</span> os<span style="color:#666">.</span>getenv(<span style="color:#4070a0">&#34;MODEL&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>INPUT_FILE <span style="color:#666">=</span> os<span style="color:#666">.</span>getenv(<span style="color:#4070a0">&#34;INPUT_FILE&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>OUTPUT_FILE <span style="color:#666">=</span> os<span style="color:#666">.</span>getenv(<span style="color:#4070a0">&#34;OUTPUT_FILE&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>TARGET_LANGUAGE <span style="color:#666">=</span> os<span style="color:#666">.</span>getenv(<span style="color:#4070a0">&#34;TARGET_LANGUAGE&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">read_markdown_file</span>(file_path):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>    <span style="color:#007020;font-weight:bold">with</span> <span style="color:#007020">open</span>(file_path, <span style="color:#4070a0">&#39;r&#39;</span>, encoding<span style="color:#666">=</span><span style="color:#4070a0">&#39;utf-8&#39;</span>) <span style="color:#007020;font-weight:bold">as</span> file:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>        <span style="color:#007020;font-weight:bold">return</span> file<span style="color:#666">.</span>read()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span><span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">write_markdown_file</span>(file_path, content):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>    <span style="color:#007020;font-weight:bold">with</span> <span style="color:#007020">open</span>(file_path, <span style="color:#4070a0">&#39;w&#39;</span>, encoding<span style="color:#666">=</span><span style="color:#4070a0">&#39;utf-8&#39;</span>) <span style="color:#007020;font-weight:bold">as</span> file:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>        file<span style="color:#666">.</span>write(content)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span><span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">translate_text</span>(text):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>    headers <span style="color:#666">=</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>        <span style="color:#4070a0">&#34;Authorization&#34;</span>: <span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Bearer </span><span style="color:#70a0d0">{</span>API_KEY<span style="color:#70a0d0">}</span><span style="color:#4070a0">&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>        <span style="color:#4070a0">&#34;Content-Type&#34;</span>: <span style="color:#4070a0">&#34;application/json&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>    prompt <span style="color:#666">=</span> <span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Translate the following text to </span><span style="color:#70a0d0">{</span>TARGET_LANGUAGE<span style="color:#70a0d0">}</span><span style="color:#4070a0"> Markdown syntax is not preserved :</span><span style="color:#4070a0;font-weight:bold">\n\n</span><span style="color:#70a0d0">{</span>text<span style="color:#70a0d0">}</span><span style="color:#4070a0">&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>    data <span style="color:#666">=</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>        <span style="color:#4070a0">&#34;model&#34;</span>: MODEL,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>        <span style="color:#4070a0">&#34;messages&#34;</span>: [{<span style="color:#4070a0">&#34;role&#34;</span>: <span style="color:#4070a0">&#34;user&#34;</span>, <span style="color:#4070a0">&#34;content&#34;</span>: prompt}]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>    response <span style="color:#666">=</span> requests<span style="color:#666">.</span>post(OPENAI_URL, headers<span style="color:#666">=</span>headers, json<span style="color:#666">=</span>data)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>    <span style="color:#007020;font-weight:bold">if</span> response<span style="color:#666">.</span>status_code <span style="color:#666">==</span> <span style="color:#40a070">200</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>        <span style="color:#007020;font-weight:bold">return</span> response<span style="color:#666">.</span>json()[<span style="color:#4070a0">&#39;choices&#39;</span>][<span style="color:#40a070">0</span>][<span style="color:#4070a0">&#39;message&#39;</span>][<span style="color:#4070a0">&#39;content&#39;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>    <span style="color:#007020;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>        <span style="color:#007020">print</span>(<span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Error: </span><span style="color:#70a0d0">{</span>response<span style="color:#666">.</span>status_code<span style="color:#70a0d0">}</span><span style="color:#4070a0"> - </span><span style="color:#70a0d0">{</span>response<span style="color:#666">.</span>text<span style="color:#70a0d0">}</span><span style="color:#4070a0">&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span>        <span style="color:#007020;font-weight:bold">return</span> <span style="color:#007020;font-weight:bold">None</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span><span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">main</span>():
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>    <span style="color:#007020;font-weight:bold">if</span> <span style="color:#007020;font-weight:bold">not</span> os<span style="color:#666">.</span>path<span style="color:#666">.</span>exists(INPUT_FILE):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>        <span style="color:#007020">print</span>(<span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Input file </span><span style="color:#70a0d0">{</span>INPUT_FILE<span style="color:#70a0d0">}</span><span style="color:#4070a0"> does not exist.&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span>        <span style="color:#007020;font-weight:bold">return</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span>    <span style="color:#60a0b0;font-style:italic"># 读取 Markdown 文件</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span>    markdown_content <span style="color:#666">=</span> read_markdown_file(INPUT_FILE)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span>    <span style="color:#60a0b0;font-style:italic"># 去除头尾的 ``` 语法</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span>    <span style="color:#60a0b0;font-style:italic"># 这里假设 markdown_content 的开头和结尾没有其他内容，只是代码块</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span>    <span style="color:#007020;font-weight:bold">if</span> markdown_content<span style="color:#666">.</span>startswith(<span style="color:#4070a0">&#39;```&#39;</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span>        markdown_content <span style="color:#666">=</span> markdown_content[<span style="color:#40a070">3</span>:]<span style="color:#666">.</span>strip()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span>    <span style="color:#007020;font-weight:bold">if</span> markdown_content<span style="color:#666">.</span>endswith(<span style="color:#4070a0">&#39;```&#39;</span>):
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span><span>        markdown_content <span style="color:#666">=</span> markdown_content[:<span style="color:#666">-</span><span style="color:#40a070">3</span>]<span style="color:#666">.</span>strip()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span><span>    <span style="color:#60a0b0;font-style:italic"># 翻译文本</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span><span>    translated_content <span style="color:#666">=</span> translate_text(markdown_content)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span><span>    <span style="color:#007020;font-weight:bold">if</span> translated_content:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span><span>        <span style="color:#60a0b0;font-style:italic"># 写入翻译后的内容到输出文件</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span>        write_markdown_file(OUTPUT_FILE, translated_content)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span>        <span style="color:#007020">print</span>(<span style="color:#4070a0">f</span><span style="color:#4070a0">&#34;Translation completed. Output saved to </span><span style="color:#70a0d0">{</span>OUTPUT_FILE<span style="color:#70a0d0">}</span><span style="color:#4070a0">.&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span><span>    <span style="color:#007020;font-weight:bold">else</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69</span><span>        <span style="color:#007020">print</span>(<span style="color:#4070a0">&#34;Translation failed.&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71</span><span><span style="color:#007020;font-weight:bold">if</span> __name__ <span style="color:#666">==</span> <span style="color:#4070a0">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72</span><span>    main()
</span></span></code></pre></div><p>文件创建完成后安装一下依赖：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>pip install requests
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>pip install python-dotenv
</span></span></code></pre></div><p>直接运行即可：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>py translate_md.py
</span></span></code></pre></div>
</content>
<p>
  
  <a href="http://localhost:1313/blog/python/">#Python</a>
  
  <a href="http://localhost:1313/blog/gpt/">#GPT</a>
  
</p>

  </main>
  <footer>Made with <a href="https://github.com/janraasch/hugo-bearblog/">Hugo ʕ•ᴥ•ʔ Bear</a>
</footer>

  
</body>

</html>
