{{ define "main" }}
<div class="wins98-window main-window">
    <div class="window-titlebar">
        <div class="window-title">
            <img src="{{ "images/home-icon.png" | relURL }}" alt="Home" class="window-icon">
            <span>{{ .Site.Title }}</span>
        </div>
        <div class="window-controls">
            <div class="minimize-btn" onclick="minimizeWindow(this)">_</div>
            <div class="maximize-btn" onclick="maximizeWindow(this)">□</div>
            <div class="close-btn" onclick="closeWindow(this)">×</div>
        </div>
    </div>
    
    <div class="window-content">
        <div class="welcome-section">
            <div class="welcome-icon">
                <img src="{{ .Site.Params.logo | default "images/author.png" | relURL }}" alt="Author" class="author-avatar">
            </div>

            {{ $articleCount := len .Site.RegularPages }}
{{ $totalWordCount := 0 }}
{{ range .Site.Pages }}
{{ $totalWordCount = add $totalWordCount .WordCount }}
{{ end }}

            <div class="welcome-text">
                <h1 class="wins98-title">{{ .Site.Title }}</h1>
                <p class="wins98-subtitle">{{ .Site.Params.description }}</p>
                <div class="stats-bar">
                    <span>运行天数：<strong id="days"></strong></span>
                    <span>文章数量：<strong>{{ len .Site.RegularPages }}</strong></span>
                    <span>总字数：<strong>{{ range .Site.Pages }}{{ $totalWordCount := add $totalWordCount .WordCount }}{{ end }}{{ $totalWordCount }}</strong></span>
                </div>
            </div>
        </div>
        
        <div class="content-section">
            {{ .Content }}
        </div>
        
        <div class="recent-posts-section">
            <h3 class="section-title">最新文章</h3>
            <div class="posts-grid">
                {{ $pages := .Site.RegularPages }}
                {{ $paginator := .Paginate ($pages) }}
                {{ range $paginator.Pages | first 6 }}
                <div class="post-card wins98-card">
                    <div class="post-header">
                        <span class="post-date">{{ .Date.Format "2006/01/02" }}</span>
                        <h4 class="post-title">{{ .Title }}</h4>
                    </div>
                    <div class="post-summary">
                        {{ .Summary | truncate 100 }}
                    </div>
                    <div class="post-footer">
                        <a href="{{ .RelPermalink }}" class="wins98-button">阅读全文</a>
                    </div>
                </div>
                {{ end }}
            </div>
        </div>
    </div>
</div>

<script>
    // 计算运行天数
    const buildDate = "{{ .Site.Params.buildDate }}";
    if (buildDate) {
        const now = new Date();
        const end = new Date(buildDate);
        const diff = Math.abs(now - end);
        const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
        document.getElementById('days').innerHTML = days;
    }
</script>
{{ end }}